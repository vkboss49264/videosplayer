<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Select a Video</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .dark-mode { background-color: #111; color: white; }
    .video-thumbnail {
      width: 100%;
      max-width: 200px;
      cursor: pointer;
      border-radius: 8px;
      transition: transform 0.2s ease-in-out;
    }
    .video-thumbnail:hover { transform: scale(1.05); }
    .search-bar { 
      width: 100%; max-width: 400px; padding: 10px; font-size: 16px; 
      border: 2px solid #007bff; background-color: #222; color: white; 
      border-radius: 5px; outline: none; transition: all 0.3s ease-in-out;
    }
    .search-bar:focus { border-color: #00bfff; }
    .search-bar::placeholder { color: #aaa; }
  </style>
</head>
<body class="dark-mode">
  <nav class="bg-gray-900 p-4 text-white flex justify-between items-center">
    <div class="text-lg font-semibold">
      <a href="index.html" class="mx-3 hover:text-blue-400 transition">Home</a>
      <a href="favorites.html" class="mx-3 hover:text-blue-400 transition">Favorites</a>
      <a href="history.html" class="mx-3 hover:text-blue-400 transition" id="historyBtn">History</a>
    </div>
    <button id="toggleDarkMode" class="bg-blue-600 px-4 py-2 rounded hover:bg-blue-500 transition">Toggle Dark Mode</button>
  </nav>

  <div class="text-center p-6">
    <h2 class="text-2xl font-bold mb-4">Select a Video to Play</h2>

    <!-- Search or Paste Link Section -->
    <div class="flex flex-col items-center">
      <input type="text" id="searchInput" placeholder="Search or paste YouTube link..." class="search-bar mt-4">
      <button id="playButton" class="bg-green-500 px-4 py-2 rounded mt-2 text-white hover:bg-green-400 transition">Play</button>
    </div>

    <p id="recentVideo" class="text-gray-300 mt-3"></p>

    <!-- Video List Section -->
    <div class="video-list grid sm:grid-cols-2 lg:grid-cols-3 gap-6 p-6">
      <div class="video-item">
        <img src="https://img.youtube.com/vi/Mxeqk6uFfF8/0.jpg" class="video-thumbnail video-btn" data-video-url="Mxeqk6uFfF8" data-title="Lesson 1">
        <button class="fav-btn bg-yellow-500 text-black px-3 py-2 rounded mt-2 w-full hover:bg-yellow-400 transition" data-video-url="Mxeqk6uFfF8" data-title="Lesson 1">⭐ Add to Favorites</button>
      </div>
      <div class="video-item">
        <img src="https://img.youtube.com/vi/FvZSiDNP6tk/0.jpg" class="video-thumbnail video-btn" data-video-url="FvZSiDNP6tk" data-title="Lesson 2">
        <button class="fav-btn bg-yellow-500 text-black px-3 py-2 rounded mt-2 w-full hover:bg-yellow-400 transition" data-video-url="FvZSiDNP6tk" data-title="Lesson 2">⭐ Add to Favorites</button>
      </div>
      <div class="video-item">
        <img src="https://img.youtube.com/vi/X1M6ak4-alM/0.jpg" class="video-thumbnail video-btn" data-video-url="X1M6ak4-alM" data-title="Lesson 3">
        <button class="fav-btn bg-yellow-500 text-black px-3 py-2 rounded mt-2 w-full hover:bg-yellow-400 transition" data-video-url="X1M6ak4-alM" data-title="Lesson 3">⭐ Add to Favorites</button>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Apply Dark Mode if enabled
      if (localStorage.getItem("darkMode") === "enabled") {
        document.body.classList.add("dark-mode");
      }

      // Function to add video to history
      function addToHistory(videoTitle, videoId) {
        let history = JSON.parse(localStorage.getItem("historyVideos")) || [];

        // Remove duplicate if exists
        history = history.filter(video => video.videoId !== videoId);

        // Add new video at the beginning
        history.unshift({ title: videoTitle, videoId });

        localStorage.setItem("historyVideos", JSON.stringify(history));
      }

      // Function to add video to favorites
      function addToFavorites(videoTitle, videoId) {
        let favorites = JSON.parse(localStorage.getItem("favorites")) || [];
        if (!favorites.some(fav => fav.videoId === videoId)) {
          favorites.push({ title: videoTitle, videoId });
          localStorage.setItem("favorites", JSON.stringify(favorites));
          alert("Added to Favorites!");
        } else {
          alert("Already in Favorites!");
        }
      }

      // Click event to play video and add to history
      document.querySelectorAll(".video-btn").forEach(button => {
        button.addEventListener("click", function() {
          const videoId = this.getAttribute("data-video-url");
          const videoTitle = this.getAttribute("data-title") || "Selected Video";  
          if (!videoId) return;  

          localStorage.setItem("lastWatched", videoTitle);
          addToHistory(videoTitle, videoId);
          window.location.href = `player.html?videoId=${videoId}`;
        });
      });

      // Right-click to add to favorites
      document.querySelectorAll(".video-btn").forEach(button => {
        button.addEventListener("contextmenu", (e) => {
          e.preventDefault();
          const videoId = button.getAttribute("data-video-url");
          const videoTitle = button.getAttribute("data-title") || "Unknown Video";  
          if (!videoId) return;

          addToFavorites(videoTitle, videoId);
        });
      });

      // Click event for "Add to Favorites" button (For mobile users)
      document.querySelectorAll(".fav-btn").forEach(button => {
        button.addEventListener("click", function() {
          const videoId = this.getAttribute("data-video-url");
          const videoTitle = this.getAttribute("data-title") || "Unknown Video";  
          if (!videoId) return;

          addToFavorites(videoTitle, videoId);
        });
      });

      // Handle Play Button Click (Search YouTube Link)
      document.getElementById("playButton").addEventListener("click", function() {
        const input = document.getElementById("searchInput").value.trim();
        let videoId = "";

        if (input.includes("youtube.com") || input.includes("youtu.be")) {
          const urlParams = new URL(input);
          if (urlParams.hostname === "youtu.be") {
            videoId = urlParams.pathname.substring(1);
          } else {
            videoId = urlParams.searchParams.get("v");
          }
        }

        if (videoId) {
          window.location.href = `player.html?videoId=${videoId}`;
        } else {
          alert("Invalid YouTube link! Please enter a valid one.");
        }
      });

    });
  </script>
</body>
</html>



